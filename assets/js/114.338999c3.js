(window.webpackJsonp=window.webpackJsonp||[]).push([[114],{460:function(s,t,a){"use strict";a.r(t);var n=a(18),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"golang语言编码规范"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#golang语言编码规范"}},[s._v("#")]),s._v(" Golang语言编码规范")]),s._v(" "),a("p",[a("a",{attrs:{"data-fancybox":"",title:"go-coding",href:"/img/goImage/go-coding.png"}},[a("img",{attrs:{src:"/img/goImage/go-coding.png",alt:"go-coding"}})])]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("版本号")]),s._v(" "),a("th",[s._v("编写人")]),s._v(" "),a("th",[s._v("更新日期")]),s._v(" "),a("th",[s._v("备注")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("1.0")]),s._v(" "),a("td",[s._v("福小林")]),s._v(" "),a("td",[s._v("2020.2.10")]),s._v(" "),a("td",[s._v("正式版")])])])]),s._v(" "),a("h2",{attrs:{id:"前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[s._v("#")]),s._v(" 前言")]),s._v(" "),a("blockquote",[a("p",[s._v("这是一份关于Go语言开发的参考手册。欲获取更多信息与文档，请访问"),a("a",{attrs:{href:"http://golang.org/",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://golang.org"),a("OutboundLink")],1),s._v("。")])]),s._v(" "),a("h2",{attrs:{id:"_1-命名规范"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-命名规范"}},[s._v("#")]),s._v(" 1 命名规范")]),s._v(" "),a("p",[s._v("命名是代码规范中很重要的一部分,统一的命名规则有利于提高的代码的可读性,好的命名仅仅通过命名就可以获取到足够多的信息。")]),s._v(" "),a("p",[s._v("Go在命名时以字母"),a("code",[s._v("a到Z或a到Z")]),s._v("或下划线开头,后面跟着零或更多的字母、下划线和数字"),a("code",[s._v("(0到9)")]),s._v("。Go不允许在命名时中使用"),a("code",[s._v("@、$和%")]),s._v("等标点符号。Go是一种区分大小写的编程语言。因此，"),a("code",[s._v("Manpower")]),s._v("和"),a("code",[s._v("manpower")]),s._v("是两个不同的命名。")]),s._v(" "),a("ul",[a("li",[s._v("1 当命名(包括常量、变量、类型、函数名、结构字段等等)以一个大写字母开头,如："),a("code",[s._v("Group1")]),s._v(",那么使用这种形式的标识符的对象就可以被外部包的代码所使用(客户端程序需要先导入这个包),这被称为导出(像面向对象语言中的 "),a("code",[s._v("public")]),s._v(")")]),s._v(" "),a("li",[s._v("2 命名如果以小写字母开头,则对包外是不可见的,但是他们在整个包的内部是可见并且可用的(像面向对象语言中的"),a("code",[s._v("private")]),s._v(")")])]),s._v(" "),a("h3",{attrs:{id:"_1-1-文件名"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-文件名"}},[s._v("#")]),s._v(" 1.1 文件名")]),s._v(" "),a("p",[s._v("尽量采取有意义的文件名，简短，有意义，应该为"),a("strong",[s._v("小写")]),s._v("单词，使用"),a("strong",[s._v("下划线")]),s._v("分隔各个单词。")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[s._v("my_test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("go")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_1-2-包命名"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-包命名"}},[s._v("#")]),s._v(" 1.2 包命名")]),s._v(" "),a("blockquote",[a("p",[s._v("保持package的名字和目录保持一致，尽量采取有意义的包名，简短，有意义，尽量和标准库不要冲突。包名应该为"),a("strong",[s._v("小写")]),s._v("单词，不要使用下划线或者混合大小写。")])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" demo\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" main\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" utils\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"_1-3-结构体命名"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-结构体命名"}},[s._v("#")]),s._v(" 1.3 结构体命名")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("采用驼峰命名法，首字母根据访问控制大写或者小写")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("struct")]),s._v("申明和初始化格式采用多行，例如下面：")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 多行申明")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" User "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    UserName  "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),s._v("\n    Email     "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 多行初始化")]),s._v("\nu "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" User"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    UserName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"astaxie"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    Email"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"astaxie@gmail.com"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])])])]),s._v(" "),a("h3",{attrs:{id:"_1-4-接口名"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-接口名"}},[s._v("#")]),s._v(" 1.4 接口名")]),s._v(" "),a("ul",[a("li",[s._v("命名规则基本和上面的结构体类型")]),s._v(" "),a("li",[s._v("单个函数的结构名以 “er” 作为后缀，例如 "),a("code",[s._v("Reader , Writer")]),s._v("。")])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" Reader "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Read")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("p "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("byte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("n "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" err "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("ul",[a("li",[a("p",[s._v("两个函数的接口名综合两个函数名")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" WriteFlusher "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Write")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("byte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Flush")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("error")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("三个以上函数的接口名，类似于结构体名")])])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" Car "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Start")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("byte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Stop")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("error")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Recover")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"_1-5-函数命名"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-函数命名"}},[s._v("#")]),s._v(" 1.5 函数命名")]),s._v(" "),a("blockquote",[a("p",[s._v("若函数或方法为判断类型（返回值主要为 "),a("code",[s._v("bool")]),s._v(" 类型），则名称应以 "),a("code",[s._v("Has")]),s._v(", "),a("code",[s._v("Is")]),s._v(", "),a("code",[s._v("Can")]),s._v(" 或 "),a("code",[s._v("Allow")]),s._v(" 等判断性动词开头：")])]),s._v(" "),a("div",{staticClass:"language-gO line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("HasPrefix")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" prefixes "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("bool")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("IsEntry")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" entries "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("bool")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("CanManage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("bool")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("AllowGitHook")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("bool")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h3",{attrs:{id:"_1-6-常量命名"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-常量命名"}},[s._v("#")]),s._v(" 1.6 常量命名")]),s._v(" "),a("blockquote",[a("p",[s._v("常量包含(布尔常量、符文常量、整数常量、浮点数常量、复数常量和字符串常量)。字符、整数、浮点数和复数常量统称为"),a("strong",[s._v("数值常量")]),s._v("。")])]),s._v(" "),a("ul",[a("li",[s._v("常量均需使用全部大写字母组成，并使用下划线分词：const APP_VER = “1.0”")]),s._v(" "),a("li",[s._v("如果是枚举类型的常量，需要先创建相应类型：")])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" Scheme "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    HTTP  Scheme "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http"')]),s._v("\n    HTTPS Scheme "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("ul",[a("li",[s._v("如果模块的功能较为复杂、常量名称容易混淆的情况下,为了更好地区分枚举类型,可以使用完整的前缀：")])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" PullRequestStatus "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("int")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    PULL_REQUEST_STATUS_CONFLICT PullRequestStatus "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("iota")]),s._v("\n    PULL_REQUEST_STATUS_CHECKING\n    PULL_REQUEST_STATUS_MERGEABLE\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h3",{attrs:{id:"_1-7-变量命名"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-7-变量命名"}},[s._v("#")]),s._v(" 1.7 变量命名")]),s._v(" "),a("blockquote",[a("p",[s._v("驼峰命名式。局部变量用小写字母开头。需要在"),a("code",[s._v("package")]),s._v("外部使用的全局变量用大写字母开头，否则用小写字母开头。")])]),s._v(" "),a("ul",[a("li",[s._v("全局变量:采用驼峰命名方式,仅限在包内的全局变量")])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[s._v("  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" ProjectName "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),s._v(" \n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//如多组变量则使用,组和声明或者平行赋值")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n      ProjectName "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),s._v(" \n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("ul",[a("li",[s._v("局部变量:采用小驼峰命名方式,注意声明局部变量尽量使用 :=")])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[s._v("    projectName "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("在相对简单的环境（对象数量少、针对性强）中,可以将一些名称由完整单词简写为单个字母，例如：")]),s._v(" "),a("ul",[a("li",[s._v("user 可以简写为 u")]),s._v(" "),a("li",[s._v("userID 可以简写 uid")]),s._v(" "),a("li",[s._v("若变量类型为 bool 类型，则名称应以 Has, Is, Can 或 Allow 开头：")])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" isExist "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("bool")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" hasConflict "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("bool")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" canManage "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("bool")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" allowGitHook "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("bool")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"_2-注释规范"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-注释规范"}},[s._v("#")]),s._v(" 2 注释规范")]),s._v(" "),a("blockquote",[a("p",[s._v("Go提供C风格的"),a("code",[s._v("/* */")]),s._v("块注释和C ++风格的"),a("code",[s._v("//")]),s._v("行注释。行注释是常态；块注释主要显示为包注释，但在表达式中很有用或禁用大量代码。")]),s._v(" "),a("ul",[a("li",[s._v("单行注释是最常见的注释形式，你可以在任何地方使用以 // 开头的单行注释")]),s._v(" "),a("li",[s._v("多行注释也叫块注释，均已以 /* 开头，并以 */ 结尾，且不可以嵌套使用，多行注释一般用于包的文档描述或注释成块的代码片段")])])]),s._v(" "),a("h3",{attrs:{id:"_2-1-包注释"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-包注释"}},[s._v("#")]),s._v(" 2.1 包注释")]),s._v(" "),a("blockquote",[a("p",[s._v("每个包都应该有一个包注释，一个位于"),a("code",[s._v("package")]),s._v("子句之前的块注释或行注释。包如果有多个go文件，只需要出现在一个go文件中（一般是和包同名的文件）即可。 包注释应该包含下面基本信息(请严格按照这个顺序，简介，创建人，创建时间）：")]),s._v(" "),a("ul",[a("li",[s._v("包的基本简介（包名，简介）")]),s._v(" "),a("li",[s._v("创建者，格式： 创建人： rtx 名")]),s._v(" "),a("li",[s._v("创建时间，格式：创建时间： yyyyMMdd")])])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// util 包， 该包包含了项目共用的一些常量，封装了项目中一些共用函数。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 创建人： hanru")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 创建时间： 20190419")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"_2-2-结构体-接口-注释"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-结构体-接口-注释"}},[s._v("#")]),s._v(" 2.2 结构体 (接口) 注释")]),s._v(" "),a("blockquote",[a("p",[s._v("每个自定义的结构体或者接口都应该有注释说明，该注释对结构进行简要介绍，放在结构体定义的前一行，格式为： 结构体名， 结构体说明。同时结构体内的每个成员变量都要有说明，该说明放在成员变量的后面（注意对齐），实例如下：")])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// User ， 用户对象，定义了用户的基础信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" User "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    Username  "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 用户名")]),s._v("\n    Email     "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 邮箱")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"_2-3-函数（方法）注释"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-函数（方法）注释"}},[s._v("#")]),s._v(" 2.3 函数（方法）注释")]),s._v(" "),a("blockquote",[a("p",[s._v("每个函数，或者方法（结构体或者接口下的函数称为方法）都应该有注释说明。")])]),s._v(" "),a("h4",{attrs:{id:"_2-3-1-函数注释"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-1-函数注释"}},[s._v("#")]),s._v(" 2.3.1 函数注释")]),s._v(" "),a("blockquote",[a("p",[s._v("// @Title 标题")]),s._v(" "),a("p",[s._v("// @Description 详细信息")]),s._v(" "),a("p",[s._v("// @Auth 创建时间 创建人")]),s._v(" "),a("p",[s._v("// @Param 参数类型 参数介绍")]),s._v(" "),a("p",[s._v('// @Return 返回类型 "错误信息"')])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// @Title NewtAttrModel ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// @Description 属性数据层操作类的工厂方法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// @Auth 福小林")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// @Param  ctx  上下文信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// @Return 属性操作类指针")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("NewAttrModel")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ctx "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("common"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("AttrModel "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h4",{attrs:{id:"_2-3-2-函数注释"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-2-函数注释"}},[s._v("#")]),s._v(" 2.3.2 函数注释")]),s._v(" "),a("blockquote",[a("p",[s._v("@Title  这个 API 所表达的含义，是一个文本，空格之后的内容全部解析为 title")]),s._v(" "),a("p",[s._v("@Description 这个 API 详细的描述，是一个文本，空格之后的内容全部解析为 Description")]),s._v(" "),a("p",[s._v("@Param  参数，表示需要传递到服务器端的参数,有五列参数,使用空格或者 tab 分割,表示的含义如下")]),s._v(" "),a("p",[s._v("1 参数名")]),s._v(" "),a("p",[s._v("2 参数类型，可以有的值是 formData、query、path、body、header，")]),s._v(" "),a("p",[s._v("3 参数类型")]),s._v(" "),a("p",[s._v("4 是否必须")]),s._v(" "),a("p",[s._v("5 注释")]),s._v(" "),a("p",[s._v("@Success  成功返回给客户端的信息")]),s._v(" "),a("p",[s._v("@Failure  失败返回的信息，包含两个参数，使用空格分隔，第一个表示 status code，第二个表示错误信息")]),s._v(" "),a("p",[s._v("@router  路由信息，包含两个参数，使用空格分隔，第一个是请求的路由地址，支持正则和自定义路由，和之前的路由规则一样，第二个参数是支持的请求方法,放在 [] 之中，如果有多个方法，那么使用 , 分隔。  ``")])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// @Title Get Product list")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// @Description 开发时间 编写人 Get Product list by some info")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// @Success 200 {object} models.ZDTProduct.ProductList")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// @Param   category_id     query   int false       "category id"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// @Param   brand_id    query   int false       "brand id"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// @Param   query   query   string  false       "query of search"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// @Param   segment query   string  false       "segment"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// @Param   sort    query   string  false       "sort option"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// @Param   dir     query   string  false       "direction asc or desc"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// @Param   offset  query   int     false       "offset"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// @Param   limit   query   int     false       "count limit"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// @Param   price           query   float       false       "price"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// @Param   special_price   query   bool        false       "whether this is special price"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// @Param   size            query   string      false       "size filter"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// @Param   color           query   string      false       "color filter"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// @Param   format          query   bool        false       "choose return format"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// @Failure 400 no enough input")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// @Failure 500 get products common error")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// @router /products [get]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])]),a("h3",{attrs:{id:"_2-4-代码逻辑注释"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-代码逻辑注释"}},[s._v("#")]),s._v(" 2.4 代码逻辑注释")]),s._v(" "),a("blockquote",[a("p",[s._v("对于一些关键位置的代码逻辑，或者局部较为复杂的逻辑，需要有相应的逻辑说明，方便其他开发者阅读该段代码，实例如下：")])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" main\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"database/sql"')]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fmt"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//执行driver.go文件中的init(),向"database/sql"注册一个mysql的驱动')]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("_")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"github.com/go-sql-driver/mysql"')]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\tdsn "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root:admin@tcp(127.0.0.1:3306)/go_test?charset=utf8"')]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//Open打开一个driverName指定的数据库，dataSourceName指定数据源")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//不会校验用户名和密码是否正确，只会对dsn的格式进行检测")]),s._v("\n\tdb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" err "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" sql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mysql"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" dsn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" err "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("nil")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//dsn格式不正确的时候会报错")]),s._v("\n\t\tfmt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Printf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"打开数据库失败,err:%v\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//尝试连接数据库，Ping方法可检查数据源名称是否合法,账号密码是否正确。")]),s._v("\n\terr "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Ping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" err "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("nil")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\tfmt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Printf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"连接数据库失败,err:%v\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\tfmt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"连接数据库成功！"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br")])]),a("h3",{attrs:{id:"_2-5-bug注释"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-bug注释"}},[s._v("#")]),s._v(" 2.5 bug注释")]),s._v(" "),a("blockquote",[a("p",[s._v("针对代码中出现的"),a("code",[s._v("bug")]),s._v("，可以使用特殊的注释，在"),a("code",[s._v("godocs")]),s._v("可以做到注释高亮：")])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// BUG(astaxie):This divides by zero. ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" i float "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"_2-6-注释风格"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-6-注释风格"}},[s._v("#")]),s._v(" 2.6 注释风格")]),s._v(" "),a("blockquote",[a("p",[s._v("统一使用中文注释,对于中英文字符之间严格使用空格分隔, 这个不仅仅是中文和英文之间,英文和中文标点之间也都要使用空格分隔,例如：")])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 从 Redis 中批量读取属性，对于没有读取到的 id ， 记录到一个数组里面，准备从 DB 中读取")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("上面 Redis 、 id 、 DB 和其他中文字符之间都是用了空格分隔。")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("建议全部使用单行注释")])]),s._v(" "),a("li",[a("p",[s._v("和代码的规范一样，单行注释不要过长，禁止超过 120 字符。")])])]),s._v(" "),a("h2",{attrs:{id:"_3-代码风格"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-代码风格"}},[s._v("#")]),s._v(" 3 代码风格")]),s._v(" "),a("h3",{attrs:{id:"_3-1-缩进和折行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-缩进和折行"}},[s._v("#")]),s._v(" 3.1  缩进和折行")]),s._v(" "),a("ul",[a("li",[s._v("缩进直接使用 "),a("code",[s._v("gofmt")]),s._v("工具格式化即可（"),a("code",[s._v("gofmt")]),s._v("是使用 "),a("code",[s._v("tab")]),s._v("缩进的）；")]),s._v(" "),a("li",[s._v("折行方面,一行最长不超过120个字符,超过的请使用换行展示,尽量保持格式优雅。")])]),s._v(" "),a("h3",{attrs:{id:"_3-2-控制结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-控制结构"}},[s._v("#")]),s._v(" 3.2 控制结构")]),s._v(" "),a("h4",{attrs:{id:"_3-2-1-语句的结尾"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-1-语句的结尾"}},[s._v("#")]),s._v(" 3.2.1 语句的结尾")]),s._v(" "),a("ul",[a("li",[s._v("Go语言中是不需要类似于"),a("code",[s._v("Java")]),s._v("需要冒号结尾，默认一行就是一条数据")]),s._v(" "),a("li",[s._v("如果你打算将多个语句写在同一行，它们则必须使用 "),a("code",[s._v(";")])])]),s._v(" "),a("h4",{attrs:{id:"_3-2-2-括号和空格"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-2-括号和空格"}},[s._v("#")]),s._v(" 3.2.2 括号和空格")]),s._v(" "),a("blockquote",[a("p",[s._v("括号和空格方面，也可以直接使用"),a("code",[s._v("gofmt")]),s._v("工具格式化（go 会强制左大括号不换行，换行会报语法错误），所有的运算符和操作数之间要留空格")])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 正确的方式")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 错误的方式")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// a ，0 和 > 之间应该空格")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 左大括号不可以换行，会报语法错误")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h4",{attrs:{id:"_3-2-3-if"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-3-if"}},[s._v("#")]),s._v(" 3.2.3 if")]),s._v(" "),a("ul",[a("li",[s._v("条件语句不需要加上圆括号")]),s._v(" "),a("li",[s._v("省略不必要的 else 语句")]),s._v(" "),a("li",[s._v("可以加上合适的初始化语句")])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[s._v("result "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("query")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" err "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("check")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" err "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("nil")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" err "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 不需要 else doSomeThing(result)")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h4",{attrs:{id:"_3-2-4-for"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-4-for"}},[s._v("#")]),s._v(" 3.2.4  for")]),s._v(" "),a("p",[s._v("Golang 只有 for 一种循环结构。")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h4",{attrs:{id:"_3-2-5-遍历"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-5-遍历"}},[s._v("#")]),s._v(" 3.2.5 遍历")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//遍历字符串")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" pos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" str "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("range")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SONY大法好"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" \n\tfmt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Printf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%q: %d\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" pos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//range可以遍历数组，切片，字典，管道和字符串。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" value "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("range")]),s._v(" oldMap "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h4",{attrs:{id:"_3-2-6-switch"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-6-switch"}},[s._v("#")]),s._v(" 3.2.6 switch")]),s._v(" "),a("ul",[a("li",[s._v("表达式不限制为常量或整数")]),s._v(" "),a("li",[a("code",[s._v("case")]),s._v(" 可以使用逗号来列举多个条件")]),s._v(" "),a("li",[s._v("无需显式"),a("code",[s._v("break")]),s._v("，但使用"),a("code",[s._v("break")]),s._v(" 可以提前结束")])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[s._v("  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Factory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" value "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" object "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("switch")]),s._v(" name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"AA"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        object "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("NewA")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"B"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        object "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("newB")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" value "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("nil")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("break")]),s._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        object"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("SetValue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" object\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("h4",{attrs:{id:"_3-2-7-类型选择"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-7-类型选择"}},[s._v("#")]),s._v(" 3.2.7 类型选择")]),s._v(" "),a("blockquote",[a("p",[s._v("对于接口变量，可以使用"),a("code",[s._v("switch")]),s._v("来判断其实际类型，这是一个很有用的技巧:")])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ErrorWrap")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("e "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("TraceableError "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" message "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("switch")]),s._v(" e "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" TraceableError"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("e\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("TraceableError"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" e\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        message "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        message "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" fmt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Sprintf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%v"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ErrorNew")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("h4",{attrs:{id:"_3-2-8-退出循环"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-8-退出循环"}},[s._v("#")]),s._v(" 3.2.8 退出循环")]),s._v(" "),a("blockquote",[a("p",[s._v("因为"),a("code",[s._v("break")]),s._v("关键字在"),a("code",[s._v("switch")]),s._v("块中有特殊含义,因此无法直接用"),a("code",[s._v("break")]),s._v("退出循环,需要借助标签:")])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" main\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fmt"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\nLoop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" index "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" index "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" index"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("switch")]),s._v(" index "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("break")]),s._v(" \n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("break")]),s._v(" Loop\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\t\t    fmt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Printf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%v\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" \n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("h4",{attrs:{id:"_3-2-9-select"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-9-select"}},[s._v("#")]),s._v(" 3.2.9 select")]),s._v(" "),a("blockquote",[a("p",[a("code",[s._v("select")]),s._v("用法类似于"),a("code",[s._v("switch")]),s._v(" ，专用于轮询多个管道的读取。")])]),s._v(" "),a("h3",{attrs:{id:"_3-3-结构体和接口"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-结构体和接口"}},[s._v("#")]),s._v(" 3.3 结构体和接口")]),s._v(" "),a("h4",{attrs:{id:"_3-3-1-结构体初始化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-1-结构体初始化"}},[s._v("#")]),s._v(" 3.3.1 结构体初始化")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[s._v("p1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("MyStruct"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// type *SyncedBuffer")]),s._v("\np2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("MyStruct"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// type *SyncedBuffer")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" s1 MyStruct "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// type SyncedBuffer")]),s._v("\ns2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" MyStruct"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// type SyncedBuffer")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("初始化时可以指定结构成员的初始值:")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" MyStruct1 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    Value "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("int")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" MyStruct2 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    MyStruct1\nID "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("int")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 直接初始化")]),s._v("\ns1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" MyStruct1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\nValue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 嵌套结构")]),s._v("\ns2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" MyStruct2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    ID"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    MyStruct1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" MyStruct1 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\nValue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h3",{attrs:{id:"_3-4-接收者"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-接收者"}},[s._v("#")]),s._v(" 3.4 接收者")]),s._v(" "),a("blockquote",[a("p",[s._v("方法的接收者既可以声明成值类型，也可以声明成指针类型。调用时，"),a("code",[s._v("Golang")]),s._v("可以自动进行转换。但是需要注意的是，声明成值类型时，调用方法时传入的是调用者的拷贝， 而不是调用者本身，因此对接收者的修改将不生效。\n接收者类型建议如下:")])]),s._v(" "),a("ul",[a("li",[s._v("map ， func ， chan :不要使用指针")]),s._v(" "),a("li",[s._v("切片类型:如果不存在对切片的重分配，")]),s._v(" "),a("li",[s._v("则不要使用指针")]),s._v(" "),a("li",[s._v("如果方法会改变接收者，必须使用指针")]),s._v(" "),a("li",[s._v("如果接收者结构有类似 sync.Mutex 等用于同步的成员，必须使用")]),s._v(" "),a("li",[s._v("一般情况，从实用性的角度出发，建议接收者都声明成指针类型")])]),s._v(" "),a("h3",{attrs:{id:"_3-5-defer"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-defer"}},[s._v("#")]),s._v(" 3.5 defer")]),s._v(" "),a("ul",[a("li",[s._v("打开文件/连接等后需要 defer 来延时执行关闭")]),s._v(" "),a("li",[s._v("慎用 defer 来处理锁")]),s._v(" "),a("li",[s._v("defer 求值是实时的，因此可以在循环中使用")])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" main\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fmt"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    word "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"world"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("defer")]),s._v(" fmt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Printf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%v\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" word"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    word "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"blueking"')]),s._v("\n    fmt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Printf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h3",{attrs:{id:"_3-5-chan"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-chan"}},[s._v("#")]),s._v(" 3.5 chan")]),s._v(" "),a("blockquote",[a("p",[a("code",[s._v("Golang")]),s._v("的并发模型基于"),a("code",[s._v("CSP")]),s._v("，并发实体("),a("code",[s._v("goroutine")]),s._v(")通过管道("),a("code",[s._v("channel")]),s._v(")进行通信。\n管道本质上是一个结构体，维护发送和队列两个队列，创建管道时使用"),a("code",[s._v("make")]),s._v(" :")])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[s._v("ch "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("chan")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("不要直接声明，这样可能会导致"),a("code",[s._v("goroutine")]),s._v("死锁:")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" ch "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("chan")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("int")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"_3-5-1-单向管道"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-1-单向管道"}},[s._v("#")]),s._v(" 3.5.1 单向管道")]),s._v(" "),a("p",[s._v("管道可以机上只读和只写声明,这种用法一般用在函数声明中:")]),s._v(" "),a("ul",[a("li",[s._v("只读管道: ch <-chan int")]),s._v(" "),a("li",[s._v("只写管道: ch chan<- int")])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("handle")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("readCh "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<-")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("chan")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" writeCh "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("chan")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("go")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\nv "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<-")]),s._v("readCh\nwriteCh "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" v\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h3",{attrs:{id:"_3-6-goroutine"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-goroutine"}},[s._v("#")]),s._v(" 3.6 goroutine")]),s._v(" "),a("blockquote",[a("p",[a("code",[s._v("goroutine")]),s._v("是"),a("code",[s._v("Glolang")]),s._v("提供的一种并发模型，可以通过关键字来启动轻量级线程来执行指定的逻辑。但需要注意的是，"),a("code",[s._v("goroutine")]),s._v("并不是协程，底层实现是个线程池，一个 "),a("code",[s._v("goroutine")]),s._v(" 在执行的过程中可能会跑在不同的线程和 "),a("code",[s._v("CPU")]),s._v(" 上。")])]),s._v(" "),a("h4",{attrs:{id:"_3-6-1-线程安全"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-1-线程安全"}},[s._v("#")]),s._v(" 3.6.1 线程安全")]),s._v(" "),a("blockquote",[a("p",[s._v("因为"),a("code",[s._v("goroutine")]),s._v("是在线程池中执行，因此我们在"),a("code",[s._v("goroutine")]),s._v("中访问闭包需要考虑线程安全的问题。")])]),s._v(" "),a("h4",{attrs:{id:"_3-6-2-once"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-2-once"}},[s._v("#")]),s._v(" 3.6.2 Once")]),s._v(" "),a("blockquote",[a("p",[a("code",[s._v("sync.Once")]),s._v("提供了一个线程安全的单次执行接口，常用于单例模式或者初始化的场景。")])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" main\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sync"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" singleton "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" instance "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("singleton\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" once sync"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Once\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("GetInstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("singleton "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    once"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Do")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        instance "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("singleton"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" instance\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h4",{attrs:{id:"_3-6-3-waitgroup"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-3-waitgroup"}},[s._v("#")]),s._v(" 3.6.3 WaitGroup")]),s._v(" "),a("blockquote",[a("p",[a("code",[s._v("Golang")]),s._v("没有提供类似 "),a("code",[s._v("thread.join")]),s._v("等待"),a("code",[s._v("goroutine")]),s._v("结束的接口,我们可以用"),a("code",[s._v("sync.WaitGroup")]),s._v("来实现:")]),s._v(" "),a("ul",[a("li",[s._v("初始化 "),a("code",[s._v("WaitGroup")]),s._v("，加上特定的值")]),s._v(" "),a("li",[s._v("激活"),a("code",[s._v("goroutine，goroutine")]),s._v("结束时记得调用"),a("code",[s._v("WaitGroup.Done()")])]),s._v(" "),a("li",[s._v("主流程执行 "),a("code",[s._v("WaitGroup.Wait()")])])])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" main\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fmt"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sync"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" wg sync"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("WaitGroup\n    wg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("go")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t        fmt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Printf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t        wg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Done")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\twg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Wait")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t    fmt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Printf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"world\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h4",{attrs:{id:"_3-6-4-atomic"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-4-atomic"}},[s._v("#")]),s._v(" 3.6.4 Atomic")]),s._v(" "),a("blockquote",[a("p",[a("code",[s._v("goroutine")]),s._v("可以使用闭包特性访问外部变量，或者多个"),a("code",[s._v("goroutine")]),s._v("共同修改同一个变量， 很容易陷入了变量并发访问的陷阱。这个时候需要借助"),a("code",[s._v("sync.atomic")]),s._v("包提供的一系列底层内存同步原语来进行同步处理。\n相比于公共变量，更推荐使用管道。")])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" main\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fmt"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sync"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sync/atomic"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" value "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("int64")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" wg sync"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("WaitGroup\n\twg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    fun "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("count "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" index "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" index "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" index"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            atomic"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("AddInt64")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// not value++")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\twg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Done")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("go")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("fun")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("go")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("fun")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\twg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Wait")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    fmt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Printf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%v\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("h3",{attrs:{id:"_3-7-import-规范"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-7-import-规范"}},[s._v("#")]),s._v(" 3.7 import 规范")]),s._v(" "),a("blockquote",[a("p",[a("code",[s._v("import")]),s._v("在多行的情况下,"),a("code",[s._v("goimports")]),s._v("会自动帮你格式化,但是我们这里还是规范一下"),a("code",[s._v("import")]),s._v("的一些规范，如果你在一个文件里面引入了一个"),a("code",[s._v("package")]),s._v(",还是建议采用如下格式：")])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fmt"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("如果你的包引入了三种类型的包，标准库包，程序内部包，第三方包，建议采用如下方式进行组织你的包：")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"encoding/json"')]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//标准包")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"strings"')]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"myproject/models"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"myproject/controller"')]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//内部包")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"myproject/utils"')]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"github.com/astaxie/beego"')]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//第三方包")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"github.com/go-sql-driver/mysql"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("有顺序的引入包，不同的类型采用空格分离，第一种实标准库，第二是项目包，第三是第三方包。")]),s._v(" "),a("p",[s._v("在项目中不要使用相对路径引入包：")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 这是不好的导入")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" “"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("net”\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 这是正确的做法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" “github"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("repo"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("proj"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("src"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("net”\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("但是如果是引入本项目中的其他包，最好使用相对路径。")]),s._v(" "),a("h3",{attrs:{id:"_3-8-错误处理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-8-错误处理"}},[s._v("#")]),s._v(" 3.8 错误处理")]),s._v(" "),a("ul",[a("li",[s._v("错误处理的原则就是不能丢弃任何有返回"),a("code",[s._v("err")]),s._v("的调用，不要使用 _ 丢弃，必须全部处理。接收到错误，要么返回"),a("code",[s._v("err")]),s._v("，或者使用"),a("code",[s._v("log")]),s._v("记录下来")]),s._v(" "),a("li",[s._v("尽早"),a("code",[s._v("return")]),s._v("：一旦有错误发生，马上返回")]),s._v(" "),a("li",[s._v("尽量不要使用"),a("code",[s._v("panic")]),s._v("，除非你知道你在做什么")]),s._v(" "),a("li",[s._v("错误描述如果是英文必须为小写，不需要标点结尾")]),s._v(" "),a("li",[s._v("采用独立的错误流进行处理")])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 错误写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" err "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("nil")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// error handling")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// normal code")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 正确写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" err "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("nil")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// error handling")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// or continue, etc.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// normal code")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h3",{attrs:{id:"_3-9-参数传递"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-9-参数传递"}},[s._v("#")]),s._v(" 3.9 参数传递")]),s._v(" "),a("ul",[a("li",[s._v("对于少量数据，不要传递指针")]),s._v(" "),a("li",[s._v("对于大量数据的"),a("code",[s._v("struct")]),s._v("可以考虑使用指针")]),s._v(" "),a("li",[s._v("传入参数是"),a("code",[s._v("map，slice，chan")]),s._v("不要传递指针,因为"),a("code",[s._v("map，slice，chan")]),s._v("是引用类型,不需要传递指针的指针")])]),s._v(" "),a("h3",{attrs:{id:"_3-10-单元测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-10-单元测试"}},[s._v("#")]),s._v(" 3.10 单元测试")]),s._v(" "),a("ul",[a("li",[s._v("1.单元测试代码的go文件必须以"),a("code",[s._v("_test.go")]),s._v("结尾，Go语言测试工具只认符合这个规则的文件")]),s._v(" "),a("li",[s._v("2.单元测试的函数名必须以"),a("code",[s._v("Test")]),s._v("开头，是可导出公开的函数。备注：函数名最好是Test+要测试的方法函数名")]),s._v(" "),a("li",[s._v("3.测试函数的签名必须接收一个指向"),a("code",[s._v("testing.T类型的指针")]),s._v("作为参数，并且该测试函数不能返回任何值")]),s._v(" "),a("li",[s._v("4."),a("a",{attrs:{href:"/go/basic/test"}},[s._v("更多参考示例")])])]),s._v(" "),a("h2",{attrs:{id:"_4-数据库规范"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-数据库规范"}},[s._v("#")]),s._v(" 4 数据库规范")]),s._v(" "),a("h3",{attrs:{id:"_4-1-总命名规范"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-总命名规范"}},[s._v("#")]),s._v(" 4.1 总命名规范")]),s._v(" "),a("ul",[a("li",[s._v("1、不得使用数据库保留关键字,以及"),a("code",[s._v("golang/php/java")]),s._v("等常用语言的保留关键字,或者可能成为关键字的单词作为完整命名。")]),s._v(" "),a("li",[s._v("2、如无特殊说明,名称必须用英文字母开头,采用有特征含义的单词或缩写,单词中间用“_”分割,且只能由英文字母、数字和下划线组成,不能用双引号包含。")]),s._v(" "),a("li",[s._v("3、除数据库名称长度为1至8个字符,其余（包括表、字段、索引等）不超过30个字符,"),a("code",[s._v("Database link")]),s._v("名称也不要超过30个字符。（30并不是凭空想象出来的，而是参考了Oracle的限制）")])]),s._v(" "),a("h3",{attrs:{id:"_4-2-建表规范"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-建表规范"}},[s._v("#")]),s._v(" 4.2 建表规范")]),s._v(" "),a("h4",{attrs:{id:"_4-2-1-表名"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-1-表名"}},[s._v("#")]),s._v(" 4.2.1 表名")]),s._v(" "),a("blockquote",[a("p",[s._v("(建议以2-3字项目名称为前缀开头),紧跟2-5个字符(英文字母或数字,但不得全是数字)的模块名(必须),\n最后跟上当前表的含义的单词(1-3个单词,用下划线连接),")])]),s._v(" "),a("div",{staticClass:"language-xml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[s._v("例如：SQ_SYS_CAR,SQ是项目名称的缩写,SYS是模块名称的缩写,CAR表示当前表的具体含义。\n特别强调：项目名称和模块名用简写(建议长度为2-5个字符),而表含义的名称,可简写、也可以不简写,但是都不能超过3个单词,\n例如下面两个反面例子：\nABF_SUPERVISION_USER，问题：模块名称似乎比较长，建议控制在2-5个字符，缩写为 ABF_SUPV_USER; \nABF_SYS_USER_MANAGE_ORG_ROLE，问题：除去前缀ABF_SYS_，表含义（USER_MANAGE_ORG_ROLE）超过了3个单词。\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h4",{attrs:{id:"_4-2-2-字段名"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-2-字段名"}},[s._v("#")]),s._v(" 4.2.2 字段名")]),s._v(" "),a("ul",[a("li",[s._v("a) 表的字段数不超过50个。")]),s._v(" "),a("li",[s._v("b) 类型：各表之间相同含义的字段，类型定义要完全相同（包括精度、默认值等）；")]),s._v(" "),a("li",[s._v("c) 命名：\n"),a("ol",[a("li",[s._v("字段名无单词数的限制，但是名字的字符长度应该符合上面的“总命名规范”。")]),s._v(" "),a("li",[s._v("字段命名及其注释，要做到清楚、无歧义。")])])])]),s._v(" "),a("div",{staticClass:"language-xml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[s._v("1 表达是与否概念的字段，必须使用is_xxx的方式命名，数据类型是unsignedtinyint\n2 字段名必须使用小写字母或数字；禁止出现数字开头，禁止两个下划线中间只出现数字。数据库字段名的修改代价很大，因为无法进行预发布，所以字段名称需要慎重考虑。\n3 小数类型为decimal，禁止使用float和double。\n4 如果存储的字符串长度几乎相等，使用char定长字符串类型。\n5 表必备三字段：id, create_time, modified_time\n6 修改字段含义或对字段表示的状态追加时，需要及时更新字段注释。\n7 字段允许适当冗余，以提高性能，但是必须考虑数据同步的情况。\n8 合适的字符存储长度，不但节约数据库表空间、节约索引存储，更重要的是提升检索速度。\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h3",{attrs:{id:"_4-3-索引规约"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-索引规约"}},[s._v("#")]),s._v(" 4.3 索引规约")]),s._v(" "),a("div",{staticClass:"language-xml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[s._v("1 【强制】业务上具有唯一特性的字段，即使是组合字段，也必须建成唯一索引\n说明：不要以为唯一索引影响了insert速度，这个速度损耗可以忽略，但提高查找速度是明显的；\n另外，即使在应用层做了非常完善的校验和控制，只要没有唯一索引，根据墨菲定律，必然有脏数据产生\n2 【强制】超过三个表禁止join。需要join的字段，数据类型保持绝对一致；多表关联查询时，保证被关联的字段需要有索引\n说明：即使双表join也要注意表索引、SQL性能。\n3.【强制】在varchar字段上建立索引时，必须指定索引长度，没必要对全字段建立索引，根据实际文本区分度决定索引长度。\n说明：索引的长度与区分度是一对矛盾体，一般对字符串类型数据，长度为20的索引，区分度会高达90%以上，可以使用count(distinctleft(列名, 索引长度))/count(*)的区分度来确定。\n4 【推荐】如果有orderby的场景，请注意利用索引的有序性。orderby最后的字段是组合索引的一部分，并且放在索引组合顺序的最后，避免出现file_sort的情况，影响查询性能。\n说明: 正例：wherea=? andb=? orderbyc;索引：a_b_c反例：索引中有范围查找，那么索引有序性无法利用，\n如：WHEREa>10 ORDERBYb;索引a_b无法排序。\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h3",{attrs:{id:"_4-4-sql规约"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-sql规约"}},[s._v("#")]),s._v(" 4.4 SQL规约")]),s._v(" "),a("div",{staticClass:"language-xml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[s._v('1 【强制】不要使用count(列名)或count(常量)来替代count(*)，count(*)就是SQL92定义的标准统计行数的语法，跟数据库无关，跟NULL和非NULL无关。\n说明：count(*)会统计值为NULL的行，而count(列名)不会统计此列为NULL值的行。\n2.【强制】count(distinctcol)计算该列除NULL之外的不重复数量。注意count(distinct col1, col2)如果其中一列全为NULL，那么即使另一列有不同的值，也返回为0。\n3.【强制】当某一列的值全是NULL时，count(col)的返回结果为0，但sum(col)的返回结果为NULL，因此使用sum()时需注意NPE问题。\n正例：可以使用如下方式来避免sum的NPE问题：SELECT IF(ISNULL(SUM(g)),0,SUM(g)) FROM table;\n4.【强制】使用ISNULL()来判断是否为NULL值。注意：NULL与任何值的直接比较都为NULL。\n说明：1）NULL<>NULL的返回结果是NULL，而不是false。2）NULL=NULL的返回结果是NULL，而不是true 3）NULL<>1的返回结果是NULL，而不是true\n5.【强制】在代码中写分页查询逻辑时，若count为0应直接返回，避免执行后面的分页语句\n6.【强制】不得使用外键与级联，一切外键概念必须在应用层解决。\n说明：（概念解释）学生表中的student_id是主键，那么成绩表中的student_id则为外键。\n如果更新学生表中的student_id，同时触发成绩表中的student_id更新，则为级联更新。\n外键与级联更新适用于单机低并发，不适合分布式、高并发集群；级联更新是强阻塞，存在数据库更新风暴的风险；外键影响数据库的插入速度。\n7.【强制】禁止使用存储过程，存储过程难以调试和扩展，更没有移植性。\n8.【强制】数据订正时，删除和修改记录时，要先select，避免出现误删除，确认无误才能执行更新语句。\n9.【推荐】in操作能避免则避免，若实在避免不了，需要仔细评估in后边的集合元素数量，控制在1000个之内。\n10.【参考】如果有全球化需要，所有的字符存储与表示，均以utf-8编码，那么字符计数方法\n说明：SELECTLENGTH("轻松工作")；返回为12  SELECTCHARACTER_LENGTH("轻松工作")；返回为4\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("h3",{attrs:{id:"_4-5-orm规约"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-5-orm规约"}},[s._v("#")]),s._v(" 4.5 ORM规约")]),s._v(" "),a("div",{staticClass:"language-xml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[s._v("1.【强制】在表查询中，一律不要使用* 作为查询的字段列表，需要哪些字段必须明确写明。\n说明：1）增加查询分析器解析成本。2）增减字段容易与resultMap配置不一致。\n2【强制】xml配置中参数注意使用：#{}，#param# 不要使用${} 此种方式容易出现SQL注入。\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h2",{attrs:{id:"_5-项目开发规范"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-项目开发规范"}},[s._v("#")]),s._v(" 5 项目开发规范")]),s._v(" "),a("h3",{attrs:{id:"_5-1-项目目录结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-项目目录结构"}},[s._v("#")]),s._v(" 5.1 项目目录结构")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("+--bin 编译后的文件\n+--pkg 本项目或其他项目使用的包\n项目根目录\n  +--api 接口规范目录\n  +--cmd\n  +--swagger 自动化API文档\n  +--test 该目录放的是临时的测试方法\n  +--config 所有的配置文件目录\n  +--internal 只在本项目使用的包\n  +-- doc 说明文档（含go-bindata和mysql文件）\n  +-- exec_package 可执行的打包文件（目前只有win 64bit的打包）\n  +-- inits 所有需初始化的目录\n  |       +-- parse 所有配置文件的初始化目录\n  |       +-- init.go 用于初始化系统root用户，并注入所有service\n  +-- middleware 包含的中间件目录\n  |       +-- casbins 用于rbac权限的中间件的目录\n  |       +-- jwts jwt中间件目录\n  +-- resources 打包的前端静态资源文件\n  |       +--img 静态图片 \n  |       +--html  网页资源\n  |       +--file 文件资源\n  +-- utils 工具包目录\n  +--plugin 插件，扩展码的包\n  +-- web\n  |       +-- db 数据库dao层目录\n  |       +-- models  models 存放实体类\n  |       +--service 业务逻辑\n  |       +-- controller 所有分发出来的路由的目录\n  |       +-- supports 提供辅助方法的目录（可以无）\n  +-- main.go 入口\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br")])]),a("h3",{attrs:{id:"_5-2-包管理器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-包管理器"}},[s._v("#")]),s._v(" 5.2 包管理器")]),s._v(" "),a("blockquote",[a("p",[s._v("统一使用"),a("code",[s._v("Go Model")]),s._v("进行包管理，对标准包，程序内部包，第三方包进行分组。 "),a("a",{attrs:{href:"http://lsdcloud.com/go/middleware/package.htm",target:"_blank",rel:"noopener noreferrer"}},[s._v("更多参考"),a("OutboundLink")],1),s._v("，")])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"encoding/json"')]),s._v("         "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//标准包")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"strings"')]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"myproject/models"')]),s._v("      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//内部包")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"myproject/utils"')]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"github.com/go-sql-driver/mysql"')]),s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//第三方包")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("常用的"),a("code",[s._v("go mod")]),s._v("命令如下：")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[s._v("go mod命令")]),s._v(" "),a("th",[s._v("描述")])])]),s._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("go mod download")]),s._v(" "),a("td",[s._v("下载依赖的module到本地cache（默认为$GOPATH/pkg/mod目录）")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("go mod edit")]),s._v(" "),a("td",[s._v("编辑go.mod文件")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("go mod graph")]),s._v(" "),a("td",[s._v("打印模块依赖图")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("go mod init")]),s._v(" "),a("td",[s._v("初始化当前文件夹, 创建go.mod文件")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("go mod tidy")]),s._v(" "),a("td",[s._v("增加缺少的module，删除无用的module")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("go mod vendor")]),s._v(" "),a("td",[s._v("将依赖复制到vendor下")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("go mod verify")]),s._v(" "),a("td",[s._v("校验依赖")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("go mod why")]),s._v(" "),a("td",[s._v("解释为什么需要依赖")])])])]),s._v(" "),a("h3",{attrs:{id:"_5-3-自动格式化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-自动格式化"}},[s._v("#")]),s._v(" 5.3 自动格式化")]),s._v(" "),a("blockquote",[a("p",[a("code",[s._v("gofmt(goimports)")]),s._v("大部分的格式问题可以通过"),a("code",[s._v("gofmt")]),s._v("解决,"),a("code",[s._v("gofmt")]),s._v("自动格式化代码,保证所有的go代码与官方推荐的格式保持一致，于是所有格式有关问题，都以"),a("code",[s._v("gofmt")]),s._v("的结果为准")])]),s._v(" "),a("h3",{attrs:{id:"_5-4-常用中间件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-4-常用中间件"}},[s._v("#")]),s._v(" 5.4 常用中间件")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[s._v("Middleware")]),s._v(" "),a("th",[s._v("描述")]),s._v(" "),a("th",[s._v("Example")])])]),s._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("a",{attrs:{href:"https://github.com/iris-contrib/middleware/tree/master/jwt",target:"_blank",rel:"noopener noreferrer"}},[s._v("jwt"),a("OutboundLink")],1)]),s._v(" "),a("td",[s._v("检查请求的Authorization头,进行JWT检查和解析")]),s._v(" "),a("td",[a("a",{attrs:{href:"https://github.com/iris-contrib/middleware/tree/master/jwt/_example",target:"_blank",rel:"noopener noreferrer"}},[s._v("jwt_example"),a("OutboundLink")],1)])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("a",{attrs:{href:"https://github.com/iris-contrib/middleware/tree/master/cors",target:"_blank",rel:"noopener noreferrer"}},[s._v("cors"),a("OutboundLink")],1)]),s._v(" "),a("td",[s._v("HTTP 跨域请求。")]),s._v(" "),a("td",[a("a",{attrs:{href:"https://github.com/iris-contrib/middleware/tree/master/cors/_example",target:"_blank",rel:"noopener noreferrer"}},[s._v("cors_example"),a("OutboundLink")],1)])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("a",{attrs:{href:"https://github.com/iris-contrib/middleware/tree/master/secure",target:"_blank",rel:"noopener noreferrer"}},[s._v("secure"),a("OutboundLink")],1)]),s._v(" "),a("td",[s._v("一些快速安全实现的中间件。")]),s._v(" "),a("td",[a("a",{attrs:{href:"https://github.com/iris-contrib/middleware/blob/master/secure/_example/main.go",target:"_blank",rel:"noopener noreferrer"}},[s._v("secure_example"),a("OutboundLink")],1)])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("a",{attrs:{href:"https://github.com/iris-contrib/middleware/tree/master/tollboothic",target:"_blank",rel:"noopener noreferrer"}},[s._v("tollbooth"),a("OutboundLink")],1)]),s._v(" "),a("td",[s._v("用于验证 HTTP 请求速率的通用中间件")]),s._v(" "),a("td",[a("a",{attrs:{href:"https://github.com/iris-contrib/middleware/tree/master/tollbooth/_examples/limit-handler",target:"_blank",rel:"noopener noreferrer"}},[s._v("tollbooth_example"),a("OutboundLink")],1)])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("a",{attrs:{href:"https://github.com/iris-contrib/middleware/tree/master/cloudwatch",target:"_blank",rel:"noopener noreferrer"}},[s._v("cloudwatch"),a("OutboundLink")],1)]),s._v(" "),a("td",[s._v("AWS cloudwatch 指标中间件。")]),s._v(" "),a("td",[a("a",{attrs:{href:"https://github.com/iris-contrib/middleware/tree/master/cloudwatch/_example",target:"_blank",rel:"noopener noreferrer"}},[s._v("cloudwatch_example"),a("OutboundLink")],1)])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("a",{attrs:{href:"https://github.com/iris-contrib/middleware/tree/master/newrelic",target:"_blank",rel:"noopener noreferrer"}},[s._v("new relic"),a("OutboundLink")],1)]),s._v(" "),a("td",[s._v("官方 New Relic Go Agent.")]),s._v(" "),a("td",[a("a",{attrs:{href:"https://github.com/iris-contrib/middleware/tree/master/newrelic/_example",target:"_blank",rel:"noopener noreferrer"}},[s._v("newrelic_example"),a("OutboundLink")],1)])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("a",{attrs:{href:"https://github.com/iris-contrib/middleware/tree/master/prometheus",target:"_blank",rel:"noopener noreferrer"}},[s._v("prometheus"),a("OutboundLink")],1)]),s._v(" "),a("td",[s._v("轻松为 prometheus 检测工具创建指标端点")]),s._v(" "),a("td",[a("a",{attrs:{href:"https://github.com/iris-contrib/middleware/tree/master/prometheus/_example",target:"_blank",rel:"noopener noreferrer"}},[s._v("prometheus_example"),a("OutboundLink")],1)])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("a",{attrs:{href:"https://github.com/iris-contrib/middleware/tree/master/casbin",target:"_blank",rel:"noopener noreferrer"}},[s._v("casbin"),a("OutboundLink")],1)]),s._v(" "),a("td",[s._v("支持各种权限模型的授权库,例如ACL,RBAC,ABAC")]),s._v(" "),a("td",[a("a",{attrs:{href:"https://github.com/iris-contrib/middleware/tree/master/casbin/_examples",target:"_blank",rel:"noopener noreferrer"}},[s._v("casbin_example"),a("OutboundLink")],1)])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("a",{attrs:{href:"https://github.com/jinzhu/gorm",target:"_blank",rel:"noopener noreferrer"}},[s._v("gorm"),a("OutboundLink")],1)]),s._v(" "),a("td",[s._v("gorm能够简化操作，提高开发效率。特别是对结构体的应用")]),s._v(" "),a("td",[a("a",{attrs:{href:"https://github.com/jinzhu/gorm",target:"_blank",rel:"noopener noreferrer"}},[s._v("gorm"),a("OutboundLink")],1)])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("a",{attrs:{href:"https://github.com/go-redis/redis",target:"_blank",rel:"noopener noreferrer"}},[s._v("go-redis"),a("OutboundLink")],1)]),s._v(" "),a("td",[s._v("go操作redis的中间件")]),s._v(" "),a("td",[a("a",{attrs:{href:"https://github.com/go-redis/redis",target:"_blank",rel:"noopener noreferrer"}},[s._v("go-redis"),a("OutboundLink")],1)])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("a",{attrs:{href:"https://github.com/spf13/viper",target:"_blank",rel:"noopener noreferrer"}},[s._v("viper"),a("OutboundLink")],1)]),s._v(" "),a("td",[s._v("Viper是Go应用程序的完整配置解决方案，包括12-Factor应用程序。")]),s._v(" "),a("td",[a("a",{attrs:{href:"https://github.com/spf13/viper",target:"_blank",rel:"noopener noreferrer"}},[s._v("viper"),a("OutboundLink")],1)])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("a",{attrs:{href:"http://github.com/json-iterator/go",target:"_blank",rel:"noopener noreferrer"}},[s._v("json-iterator"),a("OutboundLink")],1)]),s._v(" "),a("td",[s._v("json-iterator是一款快且灵活的JSON解析器,同时提供Java和Go两个版本。")]),s._v(" "),a("td",[a("a",{attrs:{href:"http://github.com/json-iterator/go",target:"_blank",rel:"noopener noreferrer"}},[s._v("json-iterator"),a("OutboundLink")],1)])])])]),s._v(" "),a("h2",{attrs:{id:"_6-安全规约"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-安全规约"}},[s._v("#")]),s._v(" 6 安全规约")]),s._v(" "),a("h3",{attrs:{id:"_6-1-权限控制校验"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-权限控制校验"}},[s._v("#")]),s._v(" 6.1 权限控制校验")]),s._v(" "),a("p",[s._v("系统所有页面必须进行权限控制校验。 防止没有做水平权限校验就可随意访问、操作别人的数据，比如查看、修改别人的数据。")]),s._v(" "),a("h3",{attrs:{id:"_6-2-数据脱敏"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-数据脱敏"}},[s._v("#")]),s._v(" 6.2 数据脱敏")]),s._v(" "),a("p",[s._v("用户敏感数据禁止直接展示，必须对展示数据脱敏。 如查看个人手机号码会显示成:158****9119，隐藏中间4位，防止隐私泄露。 身份证脱敏等等")]),s._v(" "),a("h3",{attrs:{id:"_6-3-防止sql注入"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-防止sql注入"}},[s._v("#")]),s._v(" 6.3 防止SQL注入")]),s._v(" "),a("p",[s._v("用户输入的SQL参数严格使用参数绑定或者METADATA字段值限定，防止SQL注入， 禁止字符串拼接SQL访问数据库。")]),s._v(" "),a("h3",{attrs:{id:"_6-4-参数有效性验证"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-4-参数有效性验证"}},[s._v("#")]),s._v(" 6.4 参数有效性验证")]),s._v(" "),a("p",[s._v("用户请求传入的任何参数必须做有效性验证。 忽略参数校验可能导致如下异常：")]),s._v(" "),a("ul",[a("li",[s._v("pagesize过大导致内存溢出")]),s._v(" "),a("li",[s._v("恶意orderby导致数据库慢查询")]),s._v(" "),a("li",[s._v("任意重定向")]),s._v(" "),a("li",[s._v("SQL注入")]),s._v(" "),a("li",[s._v("反序列化注入")]),s._v(" "),a("li",[s._v("正则输入源串拒绝服务ReDoS")])]),s._v(" "),a("h3",{attrs:{id:"_6-5-csrf安全过滤"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-5-csrf安全过滤"}},[s._v("#")]),s._v(" 6.5 CSRF安全过滤")]),s._v(" "),a("p",[s._v("表单、AJAX提交必须执行CSRF安全过滤。 说明：CSRF(Cross-siterequestforgery)跨站请求伪造是一类常见编程漏洞。对于存在CSRF漏洞的应用/网站，攻击者可以事先构造好URL，只要受害者用户一访问，后台便在用户不知情情况下对数据库中用户参数进行相应修改。")]),s._v(" "),a("h2",{attrs:{id:"_7-参考资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-参考资料"}},[s._v("#")]),s._v(" 7 参考资料")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/golang/go/wiki/CodeReviewComments",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/golang/go/wiki/CodeReviewComments"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("a",{attrs:{href:"https://golang.org/doc/effective_go.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://golang.org/doc/effective_go.html"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("a",{attrs:{href:"http://lsdcloud.com/go/introduction.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://lsdcloud.com/go/introduction.html "),a("OutboundLink")],1)]),s._v(" "),a("src-comment")],1)}),[],!1,null,null,null);t.default=e.exports}}]);